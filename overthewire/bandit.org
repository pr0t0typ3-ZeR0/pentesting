#+TITLE: Bandit

* Table of Contents :TOC:
- [[#level-0---1][Level 0 -> 1]]
- [[#level-1---2][Level 1 -> 2]]
- [[#level-2---3][Level 2 -> 3]]
- [[#level-3---4][Level 3 -> 4]]
- [[#level-4---5][Level 4 -> 5]]
- [[#level-5---6][Level 5 -> 6]]
- [[#level-6---7][Level 6 -> 7]]
- [[#level-7---8][Level 7 -> 8]]
- [[#level-8---9][Level 8 -> 9]]
- [[#level-9---10][Level 9 -> 10]]
- [[#level-10---11][Level 10 -> 11]]
- [[#level-11---12][Level 11 -> 12]]
- [[#level-12---13][Level 12 -> 13]]
- [[#level-13---14][Level 13 -> 14]]
- [[#level-14---15][Level 14 -> 15]]
- [[#level-15---16][Level 15 -> 16]]
- [[#level-16---17][Level 16 -> 17]]

* Level 0 -> 1
#+begin_src sh
> ls
readme

> cat readme
boJ9jbbUNNfktd78OOpsqOltutMc3MY1
#+end_src

* Level 1 -> 2
#+begin_src sh
> ls
-

> cat ./-
CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9
#+end_src

* Level 2 -> 3
#+begin_src sh
> dir
spaces\ in\ this\ filename

> cat spaces\ in\ this\ filename
UmHadQclWmgdLOKQ3YNgjWxGoRMb5luK
#+end_src

* Level 3 -> 4
#+begin_src sh
> ls
inhere

> cd inhere

> ls -a
.  ..  .hidden

> cat .hidden
pIwrPrtPN36QITSp3EQaw936yaFoFgAB
#+end_src

* Level 4 -> 5
#+begin_src sh
> ls
inhere

> cd inhere

> file ./*
./-file00: data
./-file01: data
./-file02: data
./-file03: data
./-file04: data
./-file05: data
./-file06: data
./-file07: ASCII text
./-file08: data
./-file09: data

> cat ./-file07
koReBOKuIDDepwhWk7jZC0RTdopnAYKh
#+end_src

* Level 5 -> 6
#+begin_src sh
> ls
inhere

> cd inhere

> find -type f -size 1033c
./maybehere07/.file2

> cat ./maybehere07/.file2
DXjZPULLxYr17uwoI01bNLQbtFemEgo7
#+end_src

* Level 6 -> 7
#+begin_src sh
> find / -user bandit7 -group bandit6 -size 32c 2> /dev/null
/var/lib/dpkg/info/bandit7.password

> cat /var/lib/dpkg/info/bandit7.password
HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs
#+end_src

* Level 7 -> 8
#+begin_src sh
> ls
data.txt

> cat data.txt | grep "millionth"
millionth   cvX2JJa4CFALtqS87jk27qwqGhBM9plV
#+end_src

* Level 8 -> 9
#+begin_src sh
> ls
data.txt

> cat data.txt | sort | uniq -u
UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR
#+end_src

* Level 9 -> 10
#+begin_src sh
> ls
data.txt

> cat data.txt | strings | grep =
========== the*2i"4
=:G e
========== password
<I=zsGi
Z)========== is
A=|t&E
Zdb=
c^ LAh=3G
*SF=s
&========== truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk
S=A.H&^
#+end_src

* Level 10 -> 11
  #+begin_src sh
> ls
data.txt

> cat data.txt | base64 --decode
The password is IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR
  #+end_src

* Level 11 -> 12
#+begin_src sh
> ls
data.txt

> cat data.txt | tr 'N-ZA-Mn-za-m' 'A-MN-Za-mn-z'

> The password is 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu
#+end_src

* Level 12 -> 13
#+begin_src sh
> ls
data.txt

> mkdir /tmp/zer0

> xxd -r data.txt /tmp/zer0/data

> cd /tmp/zer0

> file data
data: gzip compressed data, was "data2.bin", last modified: Thu May  7 18:14:30 2020, max compression, from Unix

> mv data data.gz

> gzip -d data.gz

> file data
data: bzip2 compressed data, block size = 900k

> bzip2 -d data
bzip2: Cannot guess original name for data -- using data.out

> file data.out
data.out: gzip compressed data, was "data4.bin", last modified: Thu May  7 18:14:30 2020, max compression, from Unix

> mv data.out data.gz

> gzip -d data.gz

> file data
data: POSIX tar archive (GNU)

> tar -x -f data

> file data5.bin
data5.bin: POSIX tar archive (GNU)

> tar -x -f data5.bin

> file data6.bin
data6.bin: bzip2 compressed data, block size = 900k

> bzip2 -d data6.bin
bzip2: Cannot guess original name for data6.bin -- using data6.bin.out

> file data6.bin.out
data6.bin.out: POSIX tar archive (GNU)

> tar -x -f data6.bin.out

> file data8.bin
data8.bin: gzip compressed data, was "data9.bin", last modified: Thu May  7 18:14:30 2020, max compression, from Unix

> mv data8.bin data8.gz

> gzip -d data8.gz

> file data8
data8: ASCII text

> cat data8
The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL
#+end_src

* Level 13 -> 14
#+begin_src sh
> ls
sshkey.private

> ssh -i sshkey.private bandit14@localhost

> cat /etc/bandit_pass/bandit14
4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e
#+end_src

* Level 14 -> 15
#+begin_src sh
> cat /etc/bandit_pass/bandit14 | nc localhost 30000
Correct!
BfMYroe26WYalil77FoDi9qh59eK5xNr
#+end_src

* Level 15 -> 16
#+begin_src sh
> openssl s_client -connect localhost:30001
...
---
BfMYroe26WYalil77FoDi9qh59eK5xNr
Correct!
cluFn7wTiGryunymYOu4RcffSxQluehd
#+end_src

* Level 16 -> 17
#+begin_src sh
> nmap -p 31000-32000 -sV localhost

Starting Nmap 7.40 ( https://nmap.org ) at 2021-02-28 18:52 CET
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00060s latency).
Not shown: 996 closed ports
PORT      STATE SERVICE     VERSION
31046/tcp open  echo
31518/tcp open  ssl/echo
31691/tcp open  echo
31790/tcp open  ssl/unknown
31960/tcp open  echo

> mkdir /tmp/zer0

> cat /etc/bandit_pass/bandit16 | openssl s_client -quiet -connect localhost:31790 > /tmp/zer0/sshkey.private
depth=0 CN = localhost
verify error:num=18:self signed certificate
verify return:1
depth=0 CN = localhost
verify return:1

> cat /tmp/zer0/sshkey.private
Correct!
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
-----END RSA PRIVATE KEY-----

> chmod 600 /tmp/zer0/sshkey.private

> ssh -i /tmp/zer0/sshkey.private bandit17@localhost

> cat /etc/bandit_pass/bandit17
xLYVMN9WE5zQ5vHacb0sZEVqbrp7nBTn
#+end_src
